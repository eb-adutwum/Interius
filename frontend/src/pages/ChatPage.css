/* =============================================
   ChatPage — Codex-style Layout for Interius
   ============================================= */

.chat-page {
    display: flex;
    height: 100vh;
    background: var(--bg-primary);
    color: var(--text-primary);
    font-family: var(--font-family);
    overflow: hidden;
}

/* ══════════════════════════════════════════════
   SIDEBAR
══════════════════════════════════════════════ */
.cp-sidebar {
    width: 248px;
    flex-shrink: 0;
    display: flex;
    flex-direction: column;
    border-right: 1px solid var(--border-subtle);
    background: var(--bg-secondary);
    overflow: hidden;
    transition: width var(--transition-base);
}

.cp-sidebar.hidden {
    width: 0;
    border-right: none;
    overflow: hidden;
}

.cp-sidebar-logo {
    padding: 18px 18px 14px;
    border-bottom: 1px solid var(--border-subtle);
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.cp-logo {
    font-size: 17px;
    font-weight: 700;
    letter-spacing: -0.04em;
    color: var(--text-primary);
    display: flex;
    align-items: baseline;
    gap: 1px;
}

.cp-logo-i {
    color: var(--text-primary);
}

.cp-logo-dot {
    color: var(--accent);
}

.cp-collapse-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 26px;
    height: 26px;
    border-radius: 6px;
    color: var(--text-muted);
    transition: all var(--transition-fast);
}

.cp-collapse-btn:hover {
    background: var(--bg-card-hover);
    color: var(--text-primary);
}

/* Collapsed sidebar rail */
.cp-sidebar-rail {
    width: 52px;
    flex-shrink: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 12px;
    padding: 16px 0 14px;
    border-right: 1px solid var(--border-subtle);
    background: var(--bg-secondary);
}

.cp-rail-logo {
    display: flex;
    align-items: baseline;
    gap: 1px;
    font-size: 17px;
    font-weight: 700;
    letter-spacing: -0.04em;
    padding: 4px 6px;
    border-radius: 8px;
    transition: background var(--transition-fast);
}

.cp-rail-logo:hover {
    background: var(--bg-card-hover);
}

.cp-rail-i {
    color: var(--text-primary);
}

.cp-rail-dot {
    color: var(--accent);
}

.cp-rail-actions {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    margin-top: 4px;
}

.cp-rail-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 34px;
    height: 34px;
    border-radius: 8px;
    color: var(--text-secondary);
    transition: all var(--transition-fast);
}

.cp-rail-btn:hover {
    background: var(--bg-card-hover);
    color: var(--text-primary);
}

/* Nav action buttons */
.cp-nav-actions {
    padding: 0 10px;
    min-height: 44px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    gap: 1px;
    border-bottom: 1px solid var(--border-subtle);
}

.cp-nav-item {
    display: flex;
    align-items: center;
    gap: 9px;
    padding: 7px 10px;
    border-radius: 8px;
    font-size: 13px;
    color: var(--text-secondary);
    text-align: left;
    transition: all var(--transition-fast);
}

.cp-nav-item:hover {
    background: var(--bg-card-hover);
    color: var(--text-primary);
}

/* Sections */
.cp-section {
    padding: 10px 10px 4px;
    border-bottom: 1px solid var(--border-subtle);
}

.cp-section-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 4px;
}

.cp-section-label {
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.06em;
    color: var(--text-muted);
    padding: 4px 2px 4px;
}

.cp-section-action {
    width: 22px;
    height: 22px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 5px;
    color: var(--text-muted);
    transition: all var(--transition-fast);
}

.cp-section-action:hover {
    background: var(--bg-card-hover);
    color: var(--text-primary);
}

/* Task items (recent) */
.cp-task-item {
    display: flex;
    align-items: center;
    gap: 7px;
    padding: 6px 6px;
    border-radius: 7px;
    font-size: 12.5px;
    color: var(--text-secondary);
    margin-bottom: 1px;
    transition: all var(--transition-fast);
}

.cp-task-item:hover {
    background: var(--bg-card-hover);
    color: var(--text-primary);
}

.cp-task-item.active {
    color: var(--text-primary);
}

.cp-task-dot {
    width: 7px;
    height: 7px;
    border-radius: 50%;
    flex-shrink: 0;
}

.cp-task-dot.active {
    background: var(--accent);
    box-shadow: 0 0 0 3px var(--accent-glow);
}

.cp-task-icon {
    flex-shrink: 0;
    color: var(--text-muted);
}

.cp-task-icon.idle {
    opacity: 0.6;
}

.cp-task-title {
    flex: 1;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.cp-task-meta {
    display: flex;
    align-items: center;
    gap: 6px;
    flex-shrink: 0;
}

.cp-task-diff {
    font-size: 10.5px;
    color: #22c55e;
    font-family: var(--font-mono);
}

.cp-task-time {
    font-size: 11px;
    color: var(--text-muted);
}

/* Thread items */
.cp-section-threads {
    flex: 1;
    overflow-y: auto;
    border-bottom: none;
}

.cp-thread-item {
    display: flex;
    align-items: center;
    gap: 8px;
    width: 100%;
    padding: 6px 8px;
    border-radius: 7px;
    text-align: left;
    font-size: 12.5px;
    color: var(--text-secondary);
    margin-bottom: 1px;
    transition: all var(--transition-fast);
    cursor: pointer;
}

.cp-thread-item:hover {
    background: var(--bg-card-hover);
    color: var(--text-primary);
}

.cp-thread-item.active {
    background: var(--bg-card-hover);
    color: var(--text-primary);
    font-weight: 500;
}

.cp-thread-title {
    flex: 1;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.cp-thread-delete {
    display: none;
    align-items: center;
    justify-content: center;
    width: 20px;
    height: 20px;
    border-radius: 5px;
    color: var(--text-muted);
    flex-shrink: 0;
    transition: all var(--transition-fast);
}

.cp-thread-rename {
    display: none;
    align-items: center;
    justify-content: center;
    width: 20px;
    height: 20px;
    border-radius: 5px;
    color: var(--text-muted);
    flex-shrink: 0;
    transition: all var(--transition-fast);
}

.cp-thread-edit-input {
    flex: 1;
    min-width: 0;
    height: 24px;
    border-radius: 6px;
    border: 1px solid var(--border-subtle);
    background: var(--bg-primary);
    color: var(--text-primary);
    padding: 2px 8px;
    font-size: 12.5px;
    outline: none;
}

.cp-thread-edit-input:focus {
    border-color: var(--accent);
    box-shadow: 0 0 0 2px var(--accent-glow);
}

.cp-thread-edit-actions {
    display: flex;
    align-items: center;
    gap: 4px;
}

.cp-thread-edit-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 20px;
    height: 20px;
    border-radius: 5px;
    color: var(--text-muted);
    flex-shrink: 0;
    transition: all var(--transition-fast);
}

.cp-thread-edit-btn:hover,
.cp-thread-rename:hover {
    background: var(--bg-card-hover);
    color: var(--text-primary);
}

.cp-thread-item:hover .cp-thread-delete {
    display: flex;
}

.cp-thread-item:hover .cp-thread-rename {
    display: flex;
}

.cp-thread-delete:hover {
    background: rgba(239, 68, 68, 0.1);
    color: #ef4444;
}

/* Sidebar footer */
.cp-sidebar-footer {
    padding: 10px 12px 14px;
    border-top: 1px solid var(--border-subtle);
    display: flex;
    align-items: center;
    gap: 8px;
}

.cp-user {
    flex: 1;
    display: flex;
    align-items: center;
    gap: 8px;
    overflow: hidden;
}

.cp-avatar {
    width: 26px;
    height: 26px;
    border-radius: 50%;
    flex-shrink: 0;
    background: var(--accent);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 11px;
    font-weight: 700;
}

.cp-user-name {
    font-size: 13px;
    font-weight: 500;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    color: var(--text-primary);
}

.cp-logout {
    width: 26px;
    height: 26px;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 6px;
    color: var(--text-muted);
    transition: all var(--transition-fast);
}

.cp-logout:hover {
    color: var(--text-primary);
    background: var(--bg-card-hover);
}


/* ══════════════════════════════════════════════
   MAIN
══════════════════════════════════════════════ */
.cp-main {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    min-width: 0;
}

/* Topbar */
.cp-topbar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 20px;
    height: 60px;
    border-bottom: 1px solid var(--border-subtle);
    flex-shrink: 0;
    gap: 12px;
}

.cp-topbar-thread {
    font-size: 13px;
    font-weight: 500;
    color: var(--text-secondary);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.cp-topbar-actions {
    display: flex;
    align-items: center;
    gap: 6px;
    flex-shrink: 0;
}

.cp-topbar-btn {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 5px 11px;
    border-radius: 7px;
    font-size: 12px;
    font-weight: 500;
    color: var(--text-secondary);
    border: 1px solid var(--border-subtle);
    background: var(--bg-secondary);
    transition: all var(--transition-fast);
}

.cp-topbar-btn:hover,
.cp-topbar-btn.on {
    border-color: var(--accent);
    color: var(--accent);
    background: var(--accent-glow);
}

.cp-tester-toggle {
    font-family: var(--font-mono);
    font-size: 11.5px;
}

/* ══════════════════════════════════════════════
   CHAT AREA
══════════════════════════════════════════════ */
.cp-chat-area {
    flex: 1;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
}

.cp-chat-loading {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    color: var(--text-muted);
    font-size: 14px;
    padding: 24px;
}

.cp-chat-loading-spinner {
    width: 14px;
    height: 14px;
    border: 2px solid var(--border-subtle);
    border-top-color: var(--accent);
    border-radius: 50%;
    animation: cp-spin 0.8s linear infinite;
}

/* Empty state */
.cp-empty {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 32px 24px 140px;
    /* extra bottom padding pushes content up */
    text-align: center;
}

.cp-empty-icon {
    color: var(--text-muted);
    margin-bottom: 18px;
    opacity: 0.7;
}

.cp-empty-heading {
    font-size: clamp(22px, 3vw, 34px);
    font-weight: 700;
    letter-spacing: -0.04em;
    color: var(--text-primary);
    margin-bottom: 6px;
}

.cp-empty-project {
    display: flex;
    align-items: center;
    gap: 4px;
    font-size: 15px;
    color: var(--text-muted);
    margin-bottom: 28px;
    cursor: pointer;
    border-radius: 8px;
    padding: 3px 8px;
    transition: background var(--transition-fast);
}

.cp-empty-project:hover {
    background: var(--bg-card-hover);
}


/* Suggestions */
.cp-suggestions {
    display: flex;
    gap: 12px;
    width: 100%;
    max-width: 720px;
    flex-wrap: wrap;
    justify-content: center;
}

.cp-suggestion {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: 8px;
    padding: 14px 18px;
    border-radius: 12px;
    text-align: left;
    background: var(--bg-secondary);
    border: 1px solid var(--border-subtle);
    transition: all var(--transition-base);
    flex: 1;
    min-width: 280px;
}

.cp-suggestion:hover {
    border-color: var(--accent);
    background: var(--accent-glow);
}

.cp-suggestion-icon {
    font-size: 20px;
}

.cp-suggestion-label {
    font-size: 12.5px;
    color: var(--text-secondary);
    line-height: 1.4;
}


/* ══════════════════════════════════════════════
   MESSAGES
══════════════════════════════════════════════ */
.cp-messages {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 60px;
    padding: 32px 32px 120px 32px;
    max-width: 900px;
    width: 100%;
    margin: 0 auto;
}

.cp-msg {
    display: flex;
    flex-direction: column;
}

.cp-msg.user {
    align-items: flex-end;
}

.cp-msg.agent {
    align-items: flex-start;
}

.cp-user-msg {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    width: 100%;
    gap: 8px;
}

.cp-bubble {
    max-width: 82%;
    width: auto;
    min-width: 0;
    align-self: flex-end;
    padding: 11px 16px;
    background: var(--bg-secondary);
    border-radius: 16px 16px 4px 16px;
    font-size: 14px;
    line-height: 1.6;
    white-space: pre-wrap;
    text-wrap: wrap;
    word-break: normal;
    overflow-wrap: break-word;
    color: var(--text-primary);
}

.cp-assistant-bubble {
    align-self: auto;
    max-width: min(82%, 760px);
    padding: 2px 0 0;
    background: transparent;
    border: none;
    border-radius: 0;
    color: var(--text-primary);
}

.cp-chat-markdown {
    white-space: normal;
}

.cp-chat-md-paragraph,
.cp-chat-md-list {
    margin: 0 0 0.85rem;
    white-space: pre-wrap;
}

.cp-chat-md-paragraph:last-child,
.cp-chat-md-list:last-child,
.cp-chat-code-block:last-child {
    margin-bottom: 0;
}

.cp-chat-md-list {
    padding-left: 1.25rem;
}

.cp-chat-md-item + .cp-chat-md-item {
    margin-top: 0.3rem;
}

.cp-chat-inline-code {
    font-family: var(--font-mono);
    font-size: 0.92em;
    padding: 0.02rem 0.2rem;
    border-radius: 4px;
    background: color-mix(in srgb, var(--bg-card) 72%, transparent);
    color: var(--text-primary);
}

.cp-chat-code-block {
    margin: 0 0 0.9rem;
    padding: 0.8rem 0.95rem;
    overflow-x: auto;
    border-radius: 10px;
    background: var(--bg-secondary);
    border: 1px solid var(--border-subtle);
}

.cp-chat-block-code {
    font-family: var(--font-mono);
    font-size: 0.93em;
    line-height: 1.65;
    white-space: pre;
    color: var(--text-primary);
}

.cp-chat-markdown .katex-display {
    margin: 0.8rem 0;
    overflow-x: auto;
    overflow-y: hidden;
}

.cp-chat-markdown .katex {
    font-size: 1em;
}

.cp-attached-files {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    justify-content: flex-end;
}

.cp-file-chip {
    display: flex;
    align-items: center;
    gap: 5px;
    padding: 4px 10px;
    border-radius: 6px;
    background: var(--bg-card);
    border: 1px solid var(--border-subtle);
    font-size: 11.5px;
    font-family: var(--font-mono);
    color: var(--text-secondary);
}

/* Agent */
.cp-agent-wrap {
    display: flex;
    align-items: flex-start;
    gap: 10px;
    width: 100%;
}

.cp-agent-avatar {
    width: 26px;
    height: 26px;
    border-radius: 50%;
    border: 1px solid var(--border-subtle);
    background: var(--bg-secondary);
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--accent);
    margin-top: 2px;
}

.cp-agent-mini-mark {
    display: inline-flex;
    align-items: baseline;
    font-size: 12px;
    font-weight: 700;
    letter-spacing: -0.02em;
    line-height: 1;
}

.cp-agent-mini-i {
    color: var(--text-primary);
}

.cp-agent-mini-dot {
    color: var(--accent);
}

.cp-agent-body {
    display: flex;
    flex-direction: column;
    gap: 16px;
    min-width: 0;
    flex: 1;
}

.cp-agent-preface {
    font-size: 14px;
    line-height: 1.55;
    color: var(--text-primary);
    margin-top: 2px;
}

/* ── Thought Process Tree ── */
.cp-thought-process {
    background: transparent;
    border: none;
    border-radius: 0;
    padding: 0;
    margin: 8px 0;
    width: 100%;
}

.cp-thought-summary {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 0;
    font-size: 13px;
    font-weight: 500;
    color: var(--text-muted);
    cursor: pointer;
    user-select: none;
    list-style: none;
    /* remove default arrow */
    opacity: 0.8;
    transition: opacity var(--transition-fast);
}

.cp-run-dot-inline {
    width: 8px;
    height: 8px;
    border-radius: 999px;
    display: inline-block;
    flex: 0 0 auto;
}

.cp-run-dot-inline.real {
    background: var(--success);
    box-shadow: 0 0 0 2px color-mix(in srgb, var(--success) 18%, transparent);
}

.cp-run-dot-inline.mock {
    background: #f59e0b;
    box-shadow: 0 0 0 2px color-mix(in srgb, #f59e0b 16%, transparent);
}

.cp-thought-summary:hover {
    opacity: 1;
}

.cp-thought-summary::-webkit-details-marker {
    display: none;
}

.cp-thought-details[open] .cp-thought-summary svg {
    transform: rotate(90deg);
}

.cp-thought-summary svg {
    transition: transform 0.2s ease;
    color: var(--text-muted);
}

.cp-thought-tree {
    padding: 8px 0 16px 14px;
    border-left: 2px solid var(--border-subtle);
    margin-left: 6px;
    display: flex;
    flex-direction: column;
    gap: 12px;
    width: calc(100% - 6px);
}

.cp-tree-node {
    display: flex;
    flex-direction: column;
    gap: 6px;
    position: relative;
}

.cp-tree-main {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 13px;
    font-weight: 500;
    width: 100%;
    min-width: 0;
}

.cp-stage-time {
    margin-left: auto;
    font-size: 11px;
    line-height: 1;
    color: var(--text-muted);
    font-family: var(--font-mono);
    background: var(--bg-card);
    border: 1px solid var(--border-subtle);
    border-radius: 999px;
    padding: 3px 7px;
    white-space: nowrap;
}

.cp-tree-node.done .cp-tree-main {
    color: var(--text-muted);
}

.cp-tree-node.running .cp-tree-main {
    color: var(--text-primary);
}

.cp-tree-node.done .cp-tree-main svg {
    color: var(--text-muted);
}

.cp-tree-node.running .cp-tree-main svg {
    color: var(--text-primary);
}

.cp-run-spinner {
    width: 12px;
    height: 12px;
    border: 2px solid var(--border-subtle);
    border-top-color: var(--text-primary);
    border-radius: 50%;
    animation: cp-spin 0.8s linear infinite;
    display: inline-block;
    position: relative;
}

.cp-run-spinner::after {
    content: "";
    position: absolute;
    width: 4px;
    height: 4px;
    border-radius: 1px;
    background: currentColor;
    inset: 0;
    margin: auto;
    opacity: 0.95;
}

.cp-run-stop-btn {
    appearance: none;
    border: none;
    background: transparent;
    padding: 0;
    margin: 0;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    border-radius: 999px;
    color: var(--text-primary);
}

.cp-run-stop-btn:hover .cp-run-spinner {
    border-top-color: #ef4444;
}

.cp-run-stop-btn:hover {
    color: #ef4444;
}

.cp-run-stop-btn:focus-visible {
    outline: 2px solid color-mix(in srgb, var(--text-primary) 35%, transparent);
    outline-offset: 2px;
}

@keyframes cp-spin {
    to {
        transform: rotate(360deg);
    }
}

.cp-tree-sub {
    display: flex;
    flex-direction: column;
    gap: 5px;
    padding-left: 5px;
    /* align with icon center */
    margin-left: 6px;
    border-left: 1px dashed var(--border-subtle);
}

.cp-tree-sub-item {
    display: flex;
    align-items: center;
    gap: 8px;
    font-family: var(--font-mono);
    font-size: 11.5px;
    color: var(--text-muted);
}

.cp-tree-elbow {
    color: var(--border-subtle);
    margin-left: 4px;
}

.cp-sub-auto {
    color: var(--text-muted);
    background: var(--bg-card);
    border: 1px solid var(--border-subtle);
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 10px;
    text-transform: uppercase;
    font-weight: 700;
    letter-spacing: 0.05em;
}

.cp-tree-link {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    color: var(--text-secondary);
    text-decoration: none;
    cursor: pointer;
    background: none;
    border: none;
    font-family: inherit;
    font-size: inherit;
    padding: 0;
    transition: color 0.15s ease;
}

.cp-tree-link:hover {
    color: var(--text-primary);
    text-decoration: underline;
}

.cp-review-stream {
    margin: 0 0 4px 20px;
    padding-left: 12px;
    border-left: 1px dashed var(--border-subtle);
    display: flex;
    flex-direction: column;
    gap: 6px;
}

.cp-review-stream-item {
    display: flex;
    align-items: flex-start;
    gap: 8px;
    font-size: 12px;
    line-height: 1.35;
    color: var(--text-muted);
}

.cp-review-stream-item .cp-review-stream-dot {
    width: 6px;
    height: 6px;
    border-radius: 999px;
    margin-top: 5px;
    background: var(--border-strong, var(--text-muted));
    flex: 0 0 auto;
    opacity: 0.9;
}

.cp-review-stream-item.revision {
    color: var(--text-secondary);
}

.cp-review-stream-item.revision .cp-review-stream-dot {
    background: #f59e0b;
}

.cp-review-stream-item.tests .cp-review-stream-dot {
    background: var(--success);
}

.cp-review-stream-item.completed .cp-review-stream-dot {
    background: var(--text-primary);
}

/* ── Review Block ── */
.cp-review-block {
    background: transparent;
    border: 1px dashed var(--border-subtle);
    border-radius: 8px;
    padding: 16px;
    display: flex;
    flex-direction: column;
    gap: 10px;
    animation: cp-fade-in 0.4s ease;
}

.cp-review-content p {
    font-size: 13.5px;
    color: var(--text-secondary);
    line-height: 1.5;
    margin: 0;
}

.cp-review-content .cp-agent-artifact-section {
    margin-top: 8px;
    gap: 6px;
}

.cp-review-content .cp-agent-files-group {
    gap: 6px;
}

.cp-review-content .cp-file-pill {
    padding: 5px 9px;
}

.cp-suggest-actions-inline {
    margin-top: 8px;
    display: flex;
    justify-content: flex-end;
    gap: 8px;
}

.cp-suggest-cancel {
    appearance: none;
    border: 1px solid var(--border-subtle);
    background: var(--bg-secondary);
    color: var(--text-secondary);
    border-radius: 8px;
    padding: 6px 10px;
    font-size: 12px;
    cursor: pointer;
    transition: all var(--transition-fast);
}

.cp-suggest-cancel:hover {
    background: var(--bg-card);
    color: var(--text-primary);
    border-color: var(--text-muted);
}

.cp-review-actions {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
}

.cp-action-approve {
    background: var(--bg-card);
    color: var(--text-primary);
    border: 1px solid var(--border-subtle);
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
}

.cp-action-approve:hover {
    background: var(--bg-secondary);
    border-color: var(--text-muted);
}

.cp-action-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    box-sizing: border-box;
    gap: 8px;
    padding: 8px 14px;
    border-radius: 6px;
    font-size: 13px;
    font-weight: 500;
    cursor: pointer;
    transition: all var(--transition-fast);
    text-decoration: none;
    line-height: 1.2;
}

.cp-action-suggest {
    background: var(--bg-secondary);
    color: var(--text-primary);
    border: 1px solid var(--border-subtle);
}

.cp-action-suggest:hover {
    background: var(--border-subtle);
}

/* ── Final Output ── */
.cp-final-output {
    display: flex;
    flex-direction: column;
    gap: 16px;
    animation: cp-fade-in 0.4s ease;
}

.cp-agent-text {
    font-size: 14px;
    line-height: 1.6;
    color: var(--text-primary);
}

.cp-agent-files-group {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
}

.cp-agent-artifact-section {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.cp-agent-artifact-label {
    font-size: 11px;
    line-height: 1;
    color: var(--text-muted);
    font-weight: 600;
    letter-spacing: 0.04em;
    text-transform: uppercase;
}

.cp-export-block {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: 10px;
    padding: 12px;
    border: 1px solid var(--border-subtle);
    border-radius: 10px;
    background: var(--bg-card);
    font-size: 13.5px;
    color: var(--text-secondary);
}

.cp-standalone-action {
    display: flex;
    align-items: flex-start;
}

.code-chip {
    padding: 6px 12px;
    border-radius: 8px;
    background: var(--bg-card);
    border: 1px solid var(--border-subtle);
    font-family: var(--font-mono);
    font-size: 12px;
    color: var(--text-secondary);
    cursor: pointer;
    transition: all 0.2s ease;
}

.code-chip:hover {
    border-color: var(--accent);
    color: var(--accent);
    background: var(--accent-glow);
}

.cp-deployment-blocks {
    display: flex;
    flex-direction: column;
    gap: 12px;
    margin-top: 12px;
    padding-top: 16px;
    border-top: 1px solid var(--border-subtle);
}

.cp-deploy-block {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: 10px;
    padding: 8px 0;
    font-size: 13.5px;
    color: var(--text-secondary);
}

.cp-deploy-content .cp-tree-link {
    color: var(--text-primary);
    font-weight: 600;
    border-bottom: 1px dashed var(--text-muted);
    padding-bottom: 1px;
    transition: border-color var(--transition-fast);
}

.cp-deploy-content .cp-tree-link:hover {
    border-color: var(--text-primary);
}

.cp-action-tester {
    background: var(--bg-card);
    color: var(--text-primary);
    border: 1px solid var(--border-subtle);
}

.cp-action-tester:hover {
    background: var(--bg-secondary);
    border-color: var(--text-muted);
}

.cp-action-live {
    background: var(--bg-card);
    color: var(--text-primary);
    border: 1px solid var(--border-subtle);
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
}

.cp-action-download {
    background: var(--bg-secondary);
    color: var(--text-primary);
    border: 1px solid var(--border-subtle);
}

.cp-action-download:hover {
    background: var(--bg-card-hover);
    border-color: var(--text-muted);
}

.cp-action-live:hover {
    background: var(--bg-secondary);
    border-color: var(--text-muted);
}

@keyframes cp-fade-in {
    from {
        opacity: 0;
        transform: translateY(6px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Trigger menus (@ and /) */
.cp-trigger-menu {
    max-width: 780px;
    margin: 0 auto 6px;
    background: var(--bg-secondary);
    border: 1px solid var(--border-subtle);
    border-radius: 10px;
    overflow: hidden;
    box-shadow: var(--shadow-md);
}

.cp-trigger-item {
    display: flex;
    align-items: center;
    gap: 10px;
    width: 100%;
    padding: 8px 14px;
    text-align: left;
    font-size: 13px;
    color: var(--text-primary);
    border-bottom: 1px solid var(--border-subtle);
    transition: background var(--transition-fast);
}

.cp-trigger-item:last-child {
    border-bottom: none;
}

.cp-trigger-item:hover {
    background: var(--bg-card-hover);
}

.cp-trigger-icon {
    color: var(--text-muted);
    display: flex;
    align-items: center;
}

.cp-trigger-cmd {
    font-family: var(--font-mono);
    font-size: 12.5px;
    color: var(--accent);
    min-width: 110px;
}

.cp-trigger-desc {
    color: var(--text-muted);
    font-size: 12px;
}


/* ══════════════════════════════════════════════
   INPUT BAR
══════════════════════════════════════════════ */
.cp-input-bar {
    padding: 36px 20px 48px;
    background: var(--bg-primary);
}

/* File preview strip */
.cp-file-preview {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    max-width: 900px;
    margin: 0 auto 8px;
}

.cp-file-tag {
    display: flex;
    align-items: center;
    gap: 5px;
    padding: 4px 8px 4px 10px;
    border-radius: 6px;
    background: var(--bg-secondary);
    border: 1px solid var(--border-subtle);
    font-size: 11.5px;
    font-family: var(--font-mono);
    color: var(--text-secondary);
    gap: 6px;
}

.cp-file-remove {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 16px;
    height: 16px;
    border-radius: 4px;
    color: var(--text-muted);
    transition: all var(--transition-fast);
}

.cp-file-remove:hover {
    background: var(--bg-card-hover);
    color: var(--text-primary);
}

.cp-file-input {
    display: none;
}

/* Main input wrapper */
.cp-input-wrap {
    max-width: 900px;
    margin: 0 auto;
    display: flex;
    align-items: center;
    gap: 6px;
    background: var(--bg-secondary);
    border: 1px solid var(--border-subtle);
    border-radius: 14px;
    padding: 8px 10px;
    transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
}

.cp-input-wrap:focus-within {
    border-color: var(--border-hover);
    box-shadow: 0 0 0 3px var(--accent-glow);
}

/* + Attach button */
.cp-input-action {
    width: 34px;
    height: 34px;
    border-radius: 9px;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-muted);
    transition: all var(--transition-fast);
}

.cp-input-action:hover {
    background: var(--bg-card-hover);
    color: var(--text-primary);
}

.cp-attach {
    margin-left: 2px;
}

/* Textarea */
.cp-textarea {
    flex: 1;
    font-size: 14px;
    line-height: 1.6;
    resize: none;
    background: none;
    color: var(--text-primary);
    max-height: 200px;
    overflow-y: auto;
    font-family: var(--font-family);
    padding: 4px 4px;
    outline: none;
    border: none;
    align-self: center;
}

.cp-textarea::placeholder {
    color: var(--text-muted);
}

/* Right actions group */
.cp-input-right {
    display: flex;
    align-items: center;
    gap: 4px;
    flex-shrink: 0;
}

.cp-mic {
    position: relative;
}

.cp-mic.recording {
    color: #ef4444;
    background: rgba(239, 68, 68, 0.1);
    animation: mic-pulse 1.2s ease-in-out infinite;
}

@keyframes mic-pulse {

    0%,
    100% {
        box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.3);
    }

    50% {
        box-shadow: 0 0 0 5px rgba(239, 68, 68, 0);
    }
}

/* Send button */
.cp-send {
    width: 34px;
    height: 34px;
    border-radius: 50%;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--bg-tertiary);
    color: var(--text-muted);
    transition: all var(--transition-fast);
}

.cp-send.active {
    background: var(--text-primary);
    color: var(--bg-primary);
}

.cp-send.active:hover {
    transform: scale(1.06);
    opacity: 0.88;
}

.cp-send.loading {
    background: var(--accent);
    color: #fff;
    cursor: pointer;
    opacity: 0.9;
}

.cp-send.loading:hover {
    transform: scale(1.04);
    opacity: 1;
}

.cp-send-stop {
    position: relative;
    width: 16px;
    height: 16px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
}

.cp-send-spinner {
    width: 14px;
    height: 14px;
    border: 2px solid rgba(255, 255, 255, 0.35);
    border-top-color: #fff;
    border-radius: 50%;
    display: inline-block;
    animation: cp-send-spin 0.7s linear infinite;
    position: absolute;
    inset: 0;
    margin: auto;
}

@keyframes cp-send-spin {
    to {
        transform: rotate(360deg);
    }
}

.cp-send-stop-square {
    width: 6px;
    height: 6px;
    border-radius: 1px;
    background: #fff;
    position: relative;
    z-index: 1;
}

/* Input footer */
.cp-input-footer {
    max-width: 900px;
    margin: 0 auto;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding-top: 4px;
}

.cp-model-selector {
    position: relative;
}

.cp-model-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: #22c55e;
    flex-shrink: 0;
}

.cp-model-name {
    font-size: 12px;
}

.cp-input-tabs {
    display: flex;
    align-items: center;
    gap: 2px;
}

.cp-tab {
    font-size: 12px;
    padding: 3px 8px;
    border-radius: 6px;
    color: var(--text-muted);
    transition: all var(--transition-fast);
}

.cp-tab:hover {
    background: var(--bg-card-hover);
    color: var(--text-secondary);
}

.cp-tab.active {
    color: var(--text-primary);
    font-weight: 500;
}

.cp-branch {
    display: flex;
    align-items: center;
    gap: 4px;
    font-size: 12px;
    color: var(--text-muted);
    margin-left: 6px;
    padding-left: 8px;
    border-left: 1px solid var(--border-subtle);
    font-family: var(--font-mono);
}


/* ══════════════════════════════════════════════
   RIGHT PANEL — API TESTER
══════════════════════════════════════════════ */
.cp-right-panel {
    flex-shrink: 0;
    overflow: hidden;
    border-left: 1px solid var(--border-subtle);
    background: var(--bg-secondary);
    display: flex;
    flex-direction: column;
}

.cp-rp-inner {
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.cp-rp-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 60px;
    padding: 0 16px;
    border-bottom: 1px solid var(--border-subtle);
    flex-shrink: 0;
}

.cp-rp-title-wrap {
    display: flex;
    align-items: center;
    gap: 8px;
    color: var(--accent);
}

.cp-rp-title {
    font-size: 13px;
    font-weight: 600;
    color: var(--text-primary);
}

.cp-rp-close {
    width: 26px;
    height: 26px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 6px;
    color: var(--text-muted);
    transition: all var(--transition-fast);
}

.cp-rp-close:hover {
    background: var(--bg-card-hover);
    color: var(--text-primary);
}

/* Swagger UI strip */
.cp-rp-swagger {
    padding: 10px 16px;
    border-bottom: 1px solid var(--border-subtle);
    background: var(--bg-secondary);
    display: flex;
    align-items: center;
}

.cp-swagger-btn {
    display: inline-flex;
    align-items: center;
    gap: 7px;
    padding: 7px 14px;
    border-radius: 8px;
    font-size: 12px;
    font-weight: 500;
    color: #16a34a;
    border: 1px solid rgba(22, 163, 74, 0.3);
    background: rgba(22, 163, 74, 0.07);
    text-decoration: none;
    transition: all var(--transition-fast);
}

.cp-swagger-btn:hover {
    background: rgba(22, 163, 74, 0.14);
    border-color: rgba(22, 163, 74, 0.55);
    color: #15803d;
}

.cp-rp-desc {
    font-size: 12px;
    color: var(--text-muted);
    line-height: 1.5;
    padding: 10px 16px 4px;
    flex-shrink: 0;
}

.cp-rp-endpoints {
    flex: 1;
    overflow-y: auto;
    padding: 8px 12px 20px;
    display: flex;
    flex-direction: column;
    gap: 8px;
}

/* Endpoint Cards */
.ep-card {
    background: var(--bg-primary);
    border: 1px solid var(--border-subtle);
    border-radius: 12px;
    padding: 14px;
    display: flex;
    flex-direction: column;
    gap: 8px;
    transition: border-color var(--transition-fast);
}

.ep-card:hover {
    border-color: var(--border-hover);
}

.ep-header {
    display: flex;
    align-items: center;
    gap: 8px;
}

.ep-method {
    font-size: 11px;
    font-weight: 700;
    font-family: var(--font-mono);
    letter-spacing: 0.04em;
    flex-shrink: 0;
}

.ep-path {
    font-size: 12.5px;
    font-family: var(--font-mono);
    color: var(--text-primary);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.ep-desc {
    font-size: 12px;
    color: var(--text-secondary);
    line-height: 1.45;
}

.ep-input-wrap {
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.ep-input-label {
    font-size: 11px;
    font-weight: 600;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.04em;
}

.ep-input {
    font-family: var(--font-mono);
    font-size: 12px;
    padding: 7px 10px;
    border-radius: 8px;
    border: 1px solid var(--border-subtle);
    background: var(--bg-secondary);
    color: var(--text-primary);
    width: 100%;
    transition: border-color var(--transition-fast);
    outline: none;
}

.ep-input::placeholder {
    color: var(--text-muted);
}

.ep-input:focus {
    border-color: var(--accent);
}

.ep-try-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    padding: 6px 14px;
    border-radius: 8px;
    font-size: 12px;
    font-weight: 600;
    color: white;
    background: var(--accent);
    transition: all var(--transition-fast);
    align-self: flex-start;
    min-width: 68px;
}

.ep-try-btn:hover:not(:disabled) {
    background: var(--accent-dim);
    transform: translateY(-1px);
}

.ep-try-btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}

.ep-spinner {
    width: 12px;
    height: 12px;
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-top-color: white;
    border-radius: 50%;
    animation: ep-spin 0.7s linear infinite;
}

@keyframes ep-spin {
    to {
        transform: rotate(360deg);
    }
}

.ep-response {
    overflow: hidden;
}

.ep-response-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 6px;
}

.ep-status-badge {
    font-size: 10px;
    font-weight: 700;
    padding: 2px 7px;
    border-radius: 4px;
    background: rgba(34, 197, 94, 0.12);
    color: #22c55e;
    font-family: var(--font-mono);
}

.ep-response-label {
    font-size: 11px;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.04em;
    font-weight: 500;
}

.ep-response-body {
    font-family: var(--font-mono);
    font-size: 11px;
    line-height: 1.6;
    color: var(--text-secondary);
    background: var(--bg-secondary);
    border: 1px solid var(--border-subtle);
    border-radius: 8px;
    padding: 10px 12px;
    overflow-x: auto;
    white-space: pre;
}


/* ══════════════════════════════════════════════
   RESPONSIVE
══════════════════════════════════════════════ */
@media (max-width: 860px) {
    .cp-sidebar {
        display: none;
    }

    .cp-suggestions {
        flex-direction: column;
        align-items: stretch;
    }

    .cp-suggestion {
        max-width: 100%;
    }

    .cp-messages {
        padding: 20px 16px;
    }

    .cp-input-bar {
        padding: 10px 14px 10px;
    }
}

@media (max-width: 1000px) {
    .cp-right-panel {
        position: fixed;
        right: 0;
        top: 0;
        height: 100vh;
        z-index: 50;
        box-shadow: var(--shadow-xl);
    }
}

/* File chips in agent response */
.cp-agent-files {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-top: 4px;
    margin-bottom: 2px;
}

.cp-file-pill {
    display: inline-flex;
    align-items: center;
    gap: 5px;
    padding: 4px 10px;
    border-radius: 6px;
    font-size: 12px;
    font-family: var(--font-mono);
    color: var(--text-secondary);
    background: var(--bg-secondary);
    border: 1px solid var(--border-subtle);
    transition: all var(--transition-fast);
    cursor: pointer;
}

.cp-file-pill:hover {
    border-color: var(--accent);
    color: var(--accent);
    background: var(--accent-glow);
}

/* Model selector dropdown */
.cp-model-selector {
    position: relative;
}

.cp-model-btn {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 4px 8px;
    border-radius: 7px;
    font-size: 12px;
    color: var(--text-secondary);
    transition: all var(--transition-fast);
    background: transparent;
}

.cp-model-btn:hover,
.cp-model-btn.open {
    background: var(--bg-card-hover);
    color: var(--text-primary);
}

.cp-model-btn svg {
    transition: transform var(--transition-fast);
}

.cp-model-btn.open svg {
    transform: rotate(180deg);
}

.cp-model-dropdown {
    position: absolute;
    bottom: calc(100% + 8px);
    left: 0;
    background: var(--bg-glass);
    backdrop-filter: blur(12px);
    border: 1px solid var(--border-subtle);
    border-radius: 12px;
    box-shadow: var(--shadow-xl);
    padding: 6px;
    min-width: 260px;
    z-index: 100;
}

.cp-model-option {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: 2px;
    width: 100%;
    padding: 10px 12px;
    border-radius: 8px;
    text-align: left;
    transition: background var(--transition-fast);
}

.cp-model-option:hover {
    background: var(--bg-card-hover);
}

.cp-model-option.selected {
    background: var(--accent-glow);
}

.cp-model-option-name {
    font-size: 13px;
    font-weight: 600;
    color: var(--text-primary);
}

.cp-model-option.selected .cp-model-option-name {
    color: var(--accent);
}

.cp-model-option-desc {
    font-size: 11.5px;
    color: var(--text-muted);
    line-height: 1.4;
}

/* ══════════════════════════════════════════════
   IDE CODE VIEWER — theme-aware variables
══════════════════════════════════════════════ */

/* Light mode (default) — GitHub Light palette */
.chat-page {
    --ide-bg: #f6f8fa;
    --ide-toolbar-bg: #eaeef2;
    --ide-border: rgba(0, 0, 0, 0.09);
    --ide-text: #24292f;
    --ide-ln: rgba(0, 0, 0, 0.22);
    --ide-row-hover: rgba(0, 0, 0, 0.03);
    --ide-filename: #57606a;
    --ide-footer-bg: #eaeef2;
    --ide-input-bg: rgba(0, 0, 0, 0.04);
    --ide-input-bd: rgba(0, 0, 0, 0.1);
    --ide-input-text: #24292f;
    --ide-input-ph: rgba(0, 0, 0, 0.3);
    --ide-input-focus: rgba(3, 47, 98, 0.35);
    --ide-btn-color: rgba(0, 0, 0, 0.35);
    --ide-btn-bd: rgba(0, 0, 0, 0.1);
    --ide-btn-active: #0550ae;
    --ide-btn-active-bd: rgba(5, 80, 174, 0.4);
    --ide-btn-active-bg: rgba(5, 80, 174, 0.08);
    --tok-keyword: #cf222e;
    --tok-string: #0a3069;
    --tok-comment: #6e7781;
    --tok-number: #0550ae;
    --tok-builtin: #8250df;
}

/* Dark mode — neutral graphite palette */
.chat-page[data-theme='dark'] {
    --ide-bg: #111416;
    --ide-toolbar-bg: #171b1f;
    --ide-border: rgba(255, 255, 255, 0.08);
    --ide-text: #e4e7eb;
    --ide-ln: rgba(228, 231, 235, 0.28);
    --ide-row-hover: rgba(255, 255, 255, 0.03);
    --ide-filename: rgba(228, 231, 235, 0.68);
    --ide-footer-bg: #171b1f;
    --ide-input-bg: rgba(255, 255, 255, 0.05);
    --ide-input-bd: rgba(255, 255, 255, 0.1);
    --ide-input-text: #e4e7eb;
    --ide-input-ph: rgba(228, 231, 235, 0.32);
    --ide-input-focus: rgba(107, 114, 128, 0.45);
    --ide-btn-color: rgba(228, 231, 235, 0.45);
    --ide-btn-bd: rgba(255, 255, 255, 0.08);
    --ide-btn-active: #93c5fd;
    --ide-btn-active-bd: rgba(147, 197, 253, 0.35);
    --ide-btn-active-bg: rgba(147, 197, 253, 0.08);
    --tok-keyword: #fda4af;
    --tok-string: #86efac;
    --tok-comment: #94a3b8;
    --tok-number: #fdba74;
    --tok-builtin: #7dd3fc;
}

.cp-file-viewer {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    background: var(--ide-bg);
}

.cp-ide-toolbar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 14px;
    background: var(--ide-toolbar-bg);
    border-bottom: 1px solid var(--ide-border);
    flex-shrink: 0;
}

.cp-ide-filename {
    font-size: 12px;
    font-family: var(--font-mono);
    color: var(--ide-filename);
}

.cp-ide-dots {
    display: flex;
    gap: 5px;
}

.cp-ide-dots span {
    width: 10px;
    height: 10px;
    border-radius: 50%;
}

.cp-ide-dots span:nth-child(1) {
    background: #f38ba8;
}

.cp-ide-dots span:nth-child(2) {
    background: #a6e3a1;
}

.cp-ide-dots span:nth-child(3) {
    background: #f9e2af;
}

.cp-ide-scroll {
    flex: 1;
    overflow: auto;
    padding: 12px 0;
}

.cp-preview-markdown {
    padding: 12px 16px 16px;
    color: var(--ide-text);
    font-size: 13px;
    line-height: 1.5;
}

.cp-preview-markdown>*:first-child {
    margin-top: 0;
}

.cp-preview-markdown>*:last-child {
    margin-bottom: 0;
}

.cp-preview-markdown h1,
.cp-preview-markdown h2,
.cp-preview-markdown h3,
.cp-preview-markdown h4,
.cp-preview-markdown h5,
.cp-preview-markdown h6 {
    margin: 0.8em 0 0.45em;
    line-height: 1.25;
    color: var(--ide-text);
    font-weight: 600;
}

.cp-preview-markdown h1 {
    font-size: 16px;
}

.cp-preview-markdown h2 {
    font-size: 14px;
}

.cp-preview-markdown h3,
.cp-preview-markdown h4,
.cp-preview-markdown h5,
.cp-preview-markdown h6 {
    font-size: 13px;
}

.cp-preview-markdown p,
.cp-preview-markdown ul,
.cp-preview-markdown ol,
.cp-preview-markdown blockquote {
    margin: 0 0 0.7em;
}

.cp-preview-markdown ul,
.cp-preview-markdown ol {
    padding-left: 1.1rem;
}

.cp-preview-markdown li {
    margin: 0.2em 0;
}

.cp-preview-markdown .cp-md-field-item {
    list-style: none;
    margin: 0.32em 0;
    position: relative;
}

.cp-preview-markdown .cp-md-field-item::before {
    content: "•";
    position: absolute;
    left: -0.95rem;
    color: var(--ide-filename);
}

.cp-md-field-row {
    display: grid;
    grid-template-columns: minmax(90px, 1.2fr) minmax(70px, auto) auto;
    gap: 8px;
    align-items: center;
    padding: 6px 8px;
    border: 1px solid var(--ide-border);
    border-radius: 8px;
    background: color-mix(in srgb, var(--ide-toolbar-bg) 72%, var(--ide-bg));
}

.cp-md-field-name {
    font-family: var(--font-mono);
    color: var(--ide-text);
    font-size: 12px;
}

.cp-md-field-type {
    font-family: var(--font-mono);
    color: var(--ide-filename);
    font-size: 11.5px;
    justify-self: start;
}

.cp-md-field-req {
    font-size: 10px;
    line-height: 1;
    padding: 4px 6px;
    border-radius: 999px;
    border: 1px solid var(--ide-border);
    color: var(--ide-filename);
    text-transform: uppercase;
    letter-spacing: 0.04em;
    font-weight: 600;
}

.cp-md-field-req.required {
    color: var(--ide-text);
    background: color-mix(in srgb, #16a34a 10%, transparent);
    border-color: color-mix(in srgb, #16a34a 32%, var(--ide-border));
}

.cp-md-field-req.optional {
    background: color-mix(in srgb, var(--ide-toolbar-bg) 65%, transparent);
}

.cp-preview-markdown hr {
    border: 0;
    border-top: 1px solid var(--ide-border);
    margin: 0.9em 0;
}

.cp-preview-markdown pre {
    margin: 0.65em 0;
}

.cp-schema-wrap {
    padding: 12px 16px 20px;
    min-height: 100%;
}

.cp-schema-title {
    margin-bottom: 12px;
    font-size: 13px;
    font-weight: 700;
    letter-spacing: 0.01em;
    color: var(--ide-text);
}

.cp-schema-canvas {
    position: relative;
}

.cp-schema-lines {
    position: absolute;
    inset: 0;
    overflow: visible;
    pointer-events: none;
}

.cp-schema-path {
    fill: none;
    stroke: color-mix(in srgb, var(--accent) 62%, var(--ide-border));
    stroke-width: 2;
    stroke-linecap: round;
    stroke-linejoin: round;
    opacity: 0.82;
}

.cp-schema-arrow {
    fill: color-mix(in srgb, var(--accent) 62%, var(--ide-border));
}

.cp-schema-card {
    position: absolute;
    overflow: hidden;
    border: 1px solid var(--ide-border);
    border-radius: 14px;
    background:
        linear-gradient(180deg, color-mix(in srgb, var(--ide-toolbar-bg) 82%, transparent), color-mix(in srgb, var(--ide-bg) 94%, transparent));
    box-shadow: 0 10px 28px rgba(0, 0, 0, 0.08);
}

.cp-schema-card-head {
    display: flex;
    align-items: center;
    min-height: 38px;
    padding: 0 14px;
    border-bottom: 1px solid var(--ide-border);
    background: color-mix(in srgb, var(--ide-toolbar-bg) 88%, transparent);
    font-size: 12px;
    font-weight: 700;
    color: var(--ide-text);
}

.cp-schema-card-body {
    padding: 10px 12px 12px;
}

.cp-schema-row {
    display: grid;
    grid-template-columns: minmax(0, 1fr) auto;
    gap: 10px;
    align-items: center;
    min-height: 26px;
    padding: 3px 0;
    border-bottom: 1px dashed color-mix(in srgb, var(--ide-border) 78%, transparent);
}

.cp-schema-row:last-child {
    border-bottom: none;
}

.cp-schema-col-main {
    min-width: 0;
    display: flex;
    align-items: center;
    gap: 8px;
}

.cp-schema-col-name {
    min-width: 0;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    font-size: 12px;
    font-weight: 600;
    color: var(--ide-text);
}

.cp-schema-flags {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    flex-shrink: 0;
}

.cp-schema-flag {
    padding: 1px 6px;
    border-radius: 999px;
    font-size: 9px;
    font-weight: 700;
    letter-spacing: 0.04em;
    border: 1px solid transparent;
}

.cp-schema-flag.pk {
    color: #8b4513;
    background: rgba(245, 158, 11, 0.16);
    border-color: rgba(245, 158, 11, 0.22);
}

.cp-schema-flag.fk {
    color: #0f766e;
    background: rgba(20, 184, 166, 0.14);
    border-color: rgba(20, 184, 166, 0.2);
}

.cp-schema-flag.nullable {
    color: var(--ide-filename);
    background: color-mix(in srgb, var(--ide-toolbar-bg) 82%, transparent);
    border-color: var(--ide-border);
}

.cp-schema-col-type {
    font-size: 11px;
    font-family: var(--font-mono);
    color: var(--ide-filename);
    white-space: nowrap;
}

.cp-schema-empty {
    padding: 16px;
    color: var(--ide-text);
}

.cp-schema-empty-title {
    margin-bottom: 10px;
    font-size: 13px;
    font-weight: 700;
}

.cp-schema-fallback {
    margin: 0;
    padding: 12px;
    border-radius: 10px;
    border: 1px solid var(--ide-border);
    background: var(--ide-toolbar-bg);
    color: var(--ide-text);
    white-space: pre-wrap;
    overflow-wrap: anywhere;
}

.cp-ide-table {
    border-collapse: collapse;
    width: 100%;
    min-width: max-content;
}

.cp-ide-row {
    line-height: 1.7;
}

.cp-ide-row:hover {
    background: var(--ide-row-hover);
}

.cp-ide-ln {
    user-select: none;
    text-align: right;
    padding: 0 16px 0 12px;
    font-size: 12px;
    font-family: var(--font-mono);
    color: var(--ide-ln);
    min-width: 40px;
    vertical-align: top;
}

.cp-ide-line {
    font-size: 12.5px;
    font-family: var(--font-mono);
    color: var(--ide-text);
    padding: 0 20px 0 0;
    white-space: pre;
    vertical-align: top;
}

/* Syntax tokens */
.tok-keyword {
    color: var(--tok-keyword);
    font-weight: 600;
}

.tok-string {
    color: var(--tok-string);
}

.tok-comment {
    color: var(--tok-comment);
    font-style: italic;
}

.tok-number {
    color: var(--tok-number);
}

.tok-builtin {
    color: var(--tok-builtin);
}

/* Suggest edits footer */
.cp-suggest-footer {
    flex-shrink: 0;
    padding: 12px 14px;
    background: var(--ide-footer-bg);
    border-top: 1px solid var(--ide-border);
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.cp-suggest-input {
    width: 100%;
    background: var(--ide-input-bg);
    border: 1px solid var(--ide-input-bd);
    border-radius: 8px;
    color: var(--ide-input-text);
    font-size: 12.5px;
    font-family: var(--font-family);
    line-height: 1.5;
    padding: 8px 10px;
    resize: none;
    outline: none;
    transition: border-color var(--transition-fast);
}

.cp-suggest-input::placeholder {
    color: var(--ide-input-ph);
}

.cp-suggest-input:focus {
    border-color: var(--ide-input-focus);
}

.cp-suggest-btn {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    align-self: flex-end;
    padding: 8px 16px;
    border-radius: 8px;
    font-size: 13px;
    font-weight: 600;
    color: var(--accent);
    border: 1px solid var(--accent);
    background: var(--bg-primary);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    transition: all var(--transition-fast);
    cursor: pointer;
}

.cp-suggest-btn.active {
    color: #ffffff;
    border-color: var(--accent);
    background: var(--accent);
    cursor: pointer;
    font-weight: 600;
}

.cp-suggest-btn.active:hover {
    background: var(--accent-hover, #2563eb);
    border-color: var(--accent-hover, #2563eb);
    box-shadow: 0 0 0 2px var(--accent-glow);
}

/* @ file-mention popup inside suggest-edits */
.cp-suggest-at-menu {
    position: absolute;
    bottom: calc(100% + 4px);
    left: 0;
    right: 0;
    background: var(--ide-toolbar-bg);
    border: 1px solid var(--ide-border);
    border-radius: 8px;
    overflow: hidden;
    z-index: 20;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.25);
}

.cp-suggest-at-item {
    display: flex;
    align-items: center;
    gap: 8px;
    width: 100%;
    padding: 8px 12px;
    font-size: 12px;
    font-family: var(--font-mono);
    color: var(--ide-text);
    text-align: left;
    background: transparent;
    transition: background var(--transition-fast);
}

.cp-suggest-at-item:hover {
    background: var(--ide-row-hover);
}

.cp-suggest-at-item svg {
    color: var(--ide-ln);
    flex-shrink: 0;
}
